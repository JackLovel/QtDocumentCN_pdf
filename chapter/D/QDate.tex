\chapter{QDate}

QDate Class

\begin{tabular}{|l|l|}
\hline
属性&	方法\\
\hline
头文件&	\#include <QDate>\\
\hline
qmake&	QT += core\\
\hline
\end{tabular}

注意： 该类提供的所有函数都是可重入的。

\splitLine

公共成员类型

\begin{tabular}{|l|l|}
\hline
类型&	名称\\
\hline
enum&	MonthNameType{ DateFormat, StandaloneFormat }\\
\hline
\end{tabular}

\splitLine

公共成员函数

\begin{longtable}{|l|l|}
\hline
类型	&函数名\\
\hline
&QDate(int y, int m, int d)\\
\hline
&QDate()\\
\hline
QDate&	addDays(qint64 ndays) const\\
\hline
QDate&	addMonths(int nmonths, QCalendar cal) const\\
\hline
QDate&	addMonths(int nmonths) const\\
\hline
QDate&	addYears(int nyears, QCalendar cal) const\\
\hline
QDate&	addYears(int nyears) const\\
\hline
int&	day(QCalendar cal) const\\
\hline
int&	day() const\\
\hline
int&	dayOfWeek(QCalendar cal) const\\
\hline
int&	dayOfWeek() const\\
\hline
int&	dayOfYear(QCalendar cal) const\\
\hline
int&	dayOfYear() const\\
\hline
int&	daysInMonth(QCalendar cal) const\\
\hline
int&	daysInMonth() const\\
\hline
int&	daysInYear(QCalendar cal) const\\
\hline
int&	daysInYear() const\\
\hline
qint64&	daysTo(const QDate \&d) const\\
\hline
QDateTime&	endOfDay(Qt::TimeSpec spec = Qt::LocalTime, int offsetSeconds = 0) const\\
\hline
QDateTime&	endOfDay(const QTimeZone \&zone) const\\
\hline
void&	getDate(int *year, int *month, int *day) const\\
\hline
bool&	isNull() const\\
\hline
bool&	isValid() const\\
\hline
int&	month(QCalendar cal) const\\
\hline
int&	month() const\\
\hline
bool&	setDate(int year, int month, int day)\\
\hline
bool&	setDate(int year, int month, int day, QCalendar cal)\\
\hline
QDateTime&	startOfDay(Qt::TimeSpec spec = Qt::LocalTime, int offsetSeconds = 0) const\\
\hline
QDateTime&	startOfDay(const QTimeZone \&zone) const\\
\hline
qint64&	toJulianDay() const\\
\hline
QString&	toString(Qt::DateFormat format = Qt::TextDate) const\\
\hline
QString&	toString(const QString \&format) const\\
\hline
QString&	toString(const QString \&format, QCalendar cal) const\\
\hline
QString&	toString(QStringView format) const\\
\hline
QString&	toString(QStringView format, QCalendar cal) const\\
\hline
int&	weekNumber(int *yearNumber = nullptr) const\\
\hline
int&	year(QCalendar cal) const\\
\hline
int&	year() const\\
\hline
bool&	operator!=(const QDate \&d) const\\
\hline
bool&	operator<(const QDate \&d) const\\
\hline
bool&	operator<=(const QDate \&d) const\\
\hline
bool&	operator==(const QDate \&d) const\\
\hline
bool&	operator>(const QDate \&d) const\\
\hline
bool&	operator>=(const QDate \&d) const\\
\hline
\end{longtable}

静态公共成员

\begin{tabular}{|l|l|}
\hline
类型&	函数名\\
\hline
QDate&	currentDate()\\
\hline
QDate&	fromJulianDay(qint64 jd)\\
\hline
QDate&	fromString(const QString \&string, Qt::DateFormat format = Qt::TextDate)\\
\hline
QDate&	fromString(const QString \&string, const QString \&format)\\
\hline
QDate&	fromString(const QString \&string, const QString \&format, QCalendar cal)\\
\hline
bool&	isLeapYear(int year)\\
\hline
bool&	isValid(int year, int month, int day)\\
\hline
\end{tabular}

\splitLine

相关非成员函数

\begin{tabular}{|l|l|}
\hline
类型&	函数名\\
\hline
QDataStream \& &	operator<<(QDataStream \&out, const QDate \&date) \\
\hline
QDataStream \&	& operator>>(QDataStream \&in, QDate \&date)\\
\hline
\end{tabular}

详细描述

无论系统的日历和地域设置如何，一个\hl{QDate}对象代表特定的一天。它可以告诉您某一天的年、月、日，其对应着格里高利历或者您提供的\hl{QCalendar}。

一个\hl{QDate} 对象一般由显式给定的年月日创建。注意 \hl{QDate} 将1~99的年数保持，不做任何偏移。静态函数currentDate()会创建一个从系统时间读取的\hl{QDate}对象。显式的日期设定也可以使用 setDate()。fromString() 函数返回一个由日期字符串和日期格式确定的日期。

year()、month()、day() 函数可以访问年月日。另外，还有 dayOfWeek()、dayOfYear() 返回一周或一年中的天数。文字形式的信息可以通过 toString()获得。天数和月数可以由 QLocale 类映射成文字。

\hl{QDate} 提供比较两个对象的全套操作，小于意味着日期靠前。

您可以通过 addDays() 给日期增减几天，同样的还有 addMonths()、addYears() 增减几个月、几年。daysTo() 函数返回两个日期相距的天数。

daysInMonth() 和 daysInYear() 函数返回一个月、一年里有几天。isLeapYear() 用于判断闰年。

特别注意

\begin{itemize}
\item 年数没有0 第0年的日期是非法的。公元后是正年份，公元前是负年份。QDate(1, 1, 1) 的前一天是 QDate(-1, 12, 31)。
\item 合法的日期范围 日期内部存储为儒略日天号，使用连续的整数记录天数，公元前4714年11月24日是格里高利历第0天（儒略历的公元前4713年1月1日）。除了可以准确有效地表示绝对日期，此类也可以用来做不同日历系统的转换。儒略历天数可以通过 QDate::toJulianDay() 和 QDate::fromJulianDay()读写。 由于技术原因，储存的儒略历天号在 -784350574879~784354017364 之间，大概是公元前2亿年到公元后2亿年之间。
\end{itemize}

另请参阅：QTime、QDateTime、QCalendar、QDateTime::YearRange、QDateEdit、QDateTimeEdit 和 QCalendarWidget。

\splitLine

成员类型文档

enum QDate::MonthNameType

此枚举描述字符串中月份名称的表示类型

\begin{tabular}{|l|l|l|}
\hline
常量	&数值&	描述\\
\hline
QDate::DateFormat&	0&	用于日期到字符串格式化。\\
\hline
QDate::StandaloneFormat	&1&	用于枚举月份和一周七天。通常单独的名字用首
  字母大写的单数形式书写。\\
\hline
\end{tabular}

此枚举在Qt 4.5中引入或修改。

\splitLine

成员函数文档

QString QDate::toString(QStringView format) const

QString QDate::toString(QStringView format, QCalendar cal) const

QString QDate::toString(const QString \&format) const

QString QDate::toString(const QString \&format, QCalendar cal) const

返回字符串形式的日期。 参数format控制输出的格式。如果传入参数cal, 它决定了使用的日历系统，默认是格里高利历。

日期格式的表示如下：

\begin{tabular}{|l|l|}
\hline
占位符 &	输出格式\\
\hline
d&	无占位0的日期 (1 to 31)\\
\hline
dd&	有占位0的日期 (01 to 31)\\
\hline
ddd&	简写的一周七天名称(例如 'Mon' to 'Sun')。使用系统地域设置来格
     式化, 也就是 QLocale::system()\\
\hline
dddd&	长版的一周七天名称 (例如 'Monday' to 'Sunday')。使用系统地域设
      置来格式化, 也就是 QLocale::system()\\
\hline
M&	无占位0的月份 (1 to 12)\\
\hline
MM&	有占位0的月份 (01 to 12)\\
\hline
MMM&	缩写的月份名称 (例如 'Jan' to 'Dec')。使用系统地域设置来格式化,
     也就是 QLocale::system()\\
\hline
MMMM&	长版的月份名称 (例如 'January' to 'December')。使用系统地域设
      置来格式化, 也就是 QLocale::system()\\
\hline
yy&	两位数年份 (00 to 99)\\
\hline
yyyy&	四位数年份。 如果是负数，加上符号是五个字符\\
\hline
\end{tabular}

单引号包裹的内容将会一字不差地放进输出到字符串中（不带外面的单引号），尽管包含上述格式占位符。连续两个单引号('')会被转义成一个单引号输出。所有其他字符不会被转义，将原封不动输出。

没有分隔符的多个占位符（例如 "ddMM"）受支持，但要慎用。因为结果的可读性不好，容易引发歧义（例如难以区分“dM”的输出"212"是清2.12还是21,2）

假设今天是1969年7月20日，下面是一些格式字符串的例子

\begin{tabular}{|l|l|}
\hline
dd.MM.yyyy	&20.07.1969\\
\hline
ddd MMMM d yy&	Sun July 20 69\\
\hline
'The day is' dddd&	The day is Sunday\\
\hline
\end{tabular}

如果日期非法，会返回空字符串。

注意： 如果需要本地化的日期表达, 请使用 QLocale::system().toString()，因为 QDate 将在 Qt 6 使用英文表达（C语言风格）。

另请参阅：fromString()、QDateTime::toString()、QTime::toString() 和
QLocale::toString()。

\splitLine

QDateTime QDate::endOfDay(Qt::TimeSpec spec = Qt::LocalTime, int offsetSeconds = 0) const

QDateTime QDate::endOfDay(const QTimeZone \&zone) const

返回这一天的最后一刻的时间。通常来说，是午夜前1ms：然而，如果时区转换让这一天跨过午夜（如夏令时），返回的是真实的最后一刻时间。这种情况只可能在使用时区参数QTimeZone zone或者本地时间参数 Qt::LocalTime spec时发生。

参数 offsetSeconds 会被忽略，除非参数 spec 为 Qt::OffsetFromUTC，其表示出了时区信息。如果UTC和那个时区间没有过渡，一天的结束是 QTime(23, 59, 59, 999)。

在罕见的日期被整体跳过（只在从东向西跨越国际日期变更线时），返回可能是非法的。将 Qt::TimeZone 作为 spec 参数传递 (而不是一个 QTimeZone) 也会造成非法结果，如果那一时刻超过了 QDateTime 的表示范围。

函数在 Qt 5.14 中引入。

另请参阅：startOfDay()。

\splitLine

QDateTime QDate::startOfDay(Qt::TimeSpec spec = Qt::LocalTime, int offsetSeconds = 0) const

QDateTime QDate::startOfDay(const QTimeZone \&zone) const

返回一天的开始时刻。通常来说应该是午夜那一时刻：然而，如果时区转换让这一天跨过午夜（如夏令时），返回的是真实的最早的一刻时间。这种情况只可能在使用时区参数QTimeZone zone或者本地时间参数 Qt::LocalTime spec时发生。

参数 offsetSeconds 会被忽略，除非参数 spec 为 Qt::OffsetFromUTC，其表示出了时区信息。如果UTC和那个时区间没有过渡，一天的结束是 QTime(0, 0)。

在罕见的日期被整体跳过（只在从东向西跨越国际日期变更线时），返回可能是非法的。

将 Qt::TimeZone 作为 spec 参数传递 (而不是一个 QTimeZone) 也会造成非法结果，如果那一时刻超过了 QDateTime 的表示范围。

函数在 Qt 5.14 中引入。

另请参阅：endOfDay()。

\splitLine

QDate::QDate(int y, int m, int d)
从年月日构造对象，使用格里高利历。如果日期非法，对象不会修改，且 isValid() 返回false。

警告： 1~99年就对应于它本身，不会偏移。第0年是非法的。

另请参阅：isValid() 和 QCalendar::dateFromParts()。

\splitLine

QDate::QDate()
构造一个空的日期，也是不可用的。

另请参阅：isNull() 和 isValid()。

\splitLine

QDate QDate::addDays(qint64 ndays) const

返回一个 ndays 天之后的新日期对象(负数意味着往前减日期)。

当当前日期或新日期是非法日期时，返回非法日期。

另请参阅：addMonths()、addYears() 和 daysTo()。

\splitLine

QDate QDate::addMonths(int nmonths) const

QDate QDate::addMonths(int nmonths, QCalendar cal) const

返回一个 nmonths 月之后的新日期对象（负数意味着往前减日期）。

如果传入 cal 参数，会使用日历系统使用，否则使用格里高利历。

注意： 如果新的日期超出年、月的合理范围，函数讲返回那个月中最接近的日期。

另请参阅：addDays() 和 addYears()。

\splitLine

QDate QDate::addYears(int nyears) const

QDate QDate::addYears(int nyears, QCalendar cal) const

返回一个 nyears 年之后的新日期对象(负数意味着往前减日期)。

如果传入 cal 参数，会使用日历系统使用，否则使用格里高利历。

注意： 如果新的日期超出年、月的合理范围，函数讲返回那个月中最接近的日期。

另请参阅：addDays() 和 addMonths()。

\splitLine

[static] QDate QDate::currentDate()

返回系统时钟所示的今天的日期对象。

另请参阅：QTime::currentTime() 和 QDateTime::currentDateTime()。

\splitLine

int QDate::day() const

int QDate::day(QCalendar cal) const

返回日期是当前月份的第几天。

如果传入 cal 参数，会使用此日历系统，否则使用格里高利历。非法日期则返回0。

一些日历系统中，返回值可能大于7。

另请参阅：year()、month() 和 dayOfWeek()。

\splitLine

int QDate::dayOfWeek() const

int QDate::dayOfWeek(QCalendar cal) const

返回日期是当前周的第几天（1=周一，7=周日）。

如果传入 cal 参数，会使用此日历系统，否则使用格里高利历。非法日期则返回0。

一些日历系统中，返回值可能大于7。

另请参阅：day()、dayOfYear() 和 Qt::DayOfWeek。

\splitLine

int QDate::dayOfYear() const

int QDate::dayOfYear(QCalendar cal) const

返回日期是当年的第几天（第一天返回1）。

如果传入 cal 参数，会使用此日历系统，否则使用格里高利历。非法日期则返回0。

另请参阅：day() 和 dayOfWeek()。

\splitLine

int QDate::daysInMonth() const

int QDate::daysInMonth(QCalendar cal) const

返回日期对应的月份中总天数。

如果传入 cal 参数，会使用此日历系统，否则使用格里高利历 (返回值是 28~31)。非法日期则返回0。

另请参阅：day() 和 daysInYear()。

\splitLine

int QDate::daysInYear() const

int QDate::daysInYear(QCalendar cal) const

返回日期对应的一年中的总天数。

如果传入 cal 参数，会使用此日历系统，否则使用格里高利历 (返回值是 365 或 366)。非法日期则返回0。

另请参阅：day() 和 daysInMonth()。

\splitLine

qint64 QDate::daysTo(const QDate \&\emph{d}) const

返回两个日期相差的天数 (\emph{d} 日期靠前则返回为负)。

如果比较的二者中有非法日期，返回0。

示例:

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../master"
%%% End: